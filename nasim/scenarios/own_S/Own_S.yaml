# A small standard (one public network) network configuration
#
# 1 subnets
# 4 hosts
# 1 OS
# 5 services
# 0 processes
# 4 exploits
# 0 priv esc
#
# Optimal path:
#  (e_http, (1, 0)) -> subnet_scan -> (e_ssh, (2, 0)) -> (pe_tomcat, (2, 0))
#      -> (e_http, (3, 1)) -> subnet_scan -> (e_ssh, (4, 0)
#      -> (pe_tomcat, (4, 0))
#  Score = 200 - (2 + 1 + 3 + 1 + 2 + 1 + 3 + 1) = 186
#
subnets: [4]
topology: [[ 1, 1, 1, 1]]
sensitive_hosts:
  (1, 0): 100
  (1, 2): 100
  (1, 3): 100
os:
  - windows
services:
  - ssh
  - ftp
  - sql
  - php
  - https
exploits:
  e_ssh:
    service: ssh
    os: windows
    prob: 1
    cost: 3
    access: user
  e_ftp:
    service: ftp
    os: windows
    prob: 1
    cost: 3
    access: user
  e_sql:
    service: sql
    os: windows
    prob: 1
    cost: 3
    access: user
  e_php:
    service: php
    os: windows
    prob: 1
    cost: 3
    access: user
service_scan_cost: 1
os_scan_cost: 1
subnet_scan_cost: 1
process_scan_cost: 1
host_configurations:
  (1, 0):
    os: windows
    services: [ssh]
    processes: []
  (1, 1):
    os: windows
    services: [https]
    processes: []
  (1, 2):
    os: windows
    services: [ftp]
    processes: []
  (1, 3):
    os: windows
    services: [sql, php]
    processes: []
# two row for each connection between subnets as defined by topology
# one for each direction of connection
# list which services to allow
firewall:
  (0, 1): []
  (1, 0): []
  (1, 2): []
  (1, 2): []
  (1, 3): [] 
step_limit: 1000
